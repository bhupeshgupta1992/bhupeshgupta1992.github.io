<!DOCTYPE html>
<html>
<head>
<title>Submit Manuscript | IJMCH</title>
<meta charset="UTF-8">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container mt-5">
  <div class="card p-4">
    <h3>Submit Manuscript</h3>

    <input type="text" id="title" class="form-control mb-2" placeholder="Manuscript Title">
    <textarea id="abstract" class="form-control mb-2" placeholder="Abstract"></textarea>
    <input type="file" id="file" class="form-control mb-3">

    <button type="button" id="submitBtn">Submit</button>
  </div>
</div>

<script type="module">

import { auth, db, storage } from "./firebase-config.js";
import { collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
import { ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js";
import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

document.addEventListener("DOMContentLoaded", () => {

  alert("Submit JS Loaded");

  function getCurrentUser() {
  return new Promise((resolve, reject) => {
    const unsubscribe = onAuthStateChanged(auth, (user) => {
      unsubscribe();
      resolve(user);
    }, reject);
  });
  }

  const submitBtn = document.getElementById("submitBtn");

  submitBtn.addEventListener("click", async () => {

  alert("Button clicked");

  try {

    await addDoc(collection(db, "submissions"), {
      title: "Test Title",
      abstract: "Test Abstract",
      status: "Submitted",
      createdAt: new Date()
    });

    alert("Firestore write successful!");

  } catch (error) {
    alert("Firestore Error: " + error.message);
  }

});

</script>

</body>
</html>
